# セッション管理機能の設計

## 要件
1. **セッション識別**: 開始からリセットまでの一連のデータを識別
2. **チャレンジ回数管理**: ユーザーが何回目のチャレンジかを記録
3. **分析用データ**: 失敗・成功セッションを区別して取得可能

## セッション定義
- **セッション開始**: ユーザーIDが設定されてゲームが開始された時点
- **セッション終了**: 以下のいずれかが発生した時点
  - ゲームクリア（成功）
  - 制約違反でゲームオーバー（失敗）
  - ユーザーがリセットボタンを押した（中断）

## データベース設計の拡張

### 新しいカラム
- `session_number`: ユーザーの何回目のチャレンジか（1から始まる連番）
- `session_status`: セッションの状態
  - 'active': 進行中
  - 'completed': ゲームクリア
  - 'failed': 制約違反
  - 'abandoned': ユーザーがリセット
- `session_start_time`: セッション開始時刻
- `session_end_time`: セッション終了時刻（NULLの場合は進行中）

### データ管理
- ユーザーごとにセッション番号を管理
- セッション開始時に新しいセッション番号を発行
- セッション終了時にステータスと終了時刻を更新

## 実装方針
1. Supabaseテーブルにカラム追加
2. セッション管理ロジックをReactアプリに実装
3. セッション開始・終了の処理を追加
4. 分析用のデータ取得関数を作成